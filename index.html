<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ุชุทุจูู ุงูุฃุฐูุงุฑ</title>

    <!-- Preload critical resources -->
    <link rel="preload" href="css/styles.css" as="style">
    <link rel="preconnect" href="https://api.aladhan.com">

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        golden: {
                            light: '#e0c97f',
                            DEFAULT: '#a67c2e',
                            dark: '#7c5c1e'
                        },
                        cream: '#fffbe6',
                        darkbg: '#23201a'
                    },
                    fontFamily: {
                        'tajawal': ['Tajawal', 'sans-serif'],
                        'amiri': ['Amiri', 'serif']
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&family=Amiri:wght@400;700&display=swap');
        /* Only font import and essential resets remain. All inline styles moved to custom.css */
    </style>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/custom.css">
    <link rel="manifest" href="manifest.json">

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
</head>
<body class="min-h-screen bg-cream dark:bg-darkbg transition-all duration-300">
    <!-- Header -->
    <header class="bg-golden-light dark:bg-golden-dark text-darkbg dark:text-cream shadow-lg transition-all duration-300 sticky top-0 z-40">
        <div class="container mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center gap-3">
                    <i class="fas fa-mosque text-2xl"></i>
                    <h1 class="text-xl md:text-2xl font-bold">ุชุทุจูู ุงูุฃุฐูุงุฑ</h1>
                </div>
                <div class="flex items-center gap-4">
                    <div class="darkmode-toggle-container">
                        <button id="darkmode-toggle" aria-label="ุชุจุฏูู ุงููุถุน ุงููููู" class="btn-main darkmode-toggle">
                            <span id="darkmode-emoji-sun" class="darkmode-emoji sun">โ๏ธ</span>
                            <span id="darkmode-emoji-moon" class="darkmode-emoji moon">๐</span>
                            <span id="darkmode-knob" class="darkmode-knob"></span>
                        </button>
                    </div>
                    <button id="profile-slider-btn" aria-label="ุงููุงุฆูุฉ ุงูุดุฎุตูุฉ" class="btn-main p-2 rounded-full">
                        <i class="fas fa-bars text-xl" aria-hidden="true"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Sidebar -->
    <div id="profile-sidebar-container"></div>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-6">
        <!-- Prayer Times Section -->
        <section class="mb-8">
            <h2 class="text-xl md:text-2xl font-bold mb-8 text-golden dark:text-golden-light border-b-2 border-golden pb-2 inline-block">
                ููุงููุช ุงูุตูุงุฉ ูุงุชุฌุงู ุงููุจูุฉ
            </h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Prayer Times Card -->
                <div class="bg-white/90 dark:bg-darkbg/90 rounded-xl border-2 border-golden-light dark:border-golden p-4 transition-all duration-300">
                    <div id="prayer-times-container">
                        <div id="next-prayer-countdown" class="text-center py-2 bg-golden/10 dark:bg-golden-dark/20 rounded-lg mb-4 text-golden-dark dark:text-golden-light"></div>
                        <ul id="prayer-times-list" class="space-y-3">
                            <li class="skeleton-loading h-16 rounded-lg"></li>
                            <li class="skeleton-loading h-16 rounded-lg"></li>
                            <li class="skeleton-loading h-16 rounded-lg"></li>
                            <li class="skeleton-loading h-16 rounded-lg"></li>
                            <li class="skeleton-loading h-16 rounded-lg"></li>
                        </ul>
                    </div>
                </div>
                <!-- Qibla Compass Card -->
                <div class="bg-white/90 dark:bg-darkbg/90 rounded-xl border-2 border-golden-light dark:border-golden p-4 text-center transition-all duration-300">
                    <div class="flex flex-col items-center justify-center h-full">
                        <div id="qibla-compass" class="qibla-compass mx-auto mb-4">
                            <div id="qibla-arrow" class="qibla-arrow"></div>
                            <div id="qibla-center" class="qibla-center"></div>
                            <span class="qibla-label qibla-n">N</span>
                            <span class="qibla-label qibla-s">S</span>
                            <span class="qibla-label qibla-w">W</span>
                            <span class="qibla-label qibla-e">E</span>
                        </div>
                        <p class="text-golden-dark dark:text-golden-light text-lg mb-2">ุงุชุฌุงู ุงููุจูุฉ</p>
                        <div id="qibla-bearing-display" class="text-xl font-bold text-golden-dark dark:text-golden-light mb-3">--ยฐ</div>
                        <button id="qibla-start" class="btn-main">
                            ุชูุนูู ุงูุจูุตูุฉ
                        </button>
                        <button id="manual-location" class="btn-link mt-2 text-sm">
                            ุชุนููู ุงููููุน ูุฏูููุง
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Tasbeeh Counter Header -->
        <h2 class="label-section">
            ุนุฏุงุฏ ุงูุชุณุจูุญ
        </h2>
        <!-- Tasbeeh Counter Section -->
        <section class="bg-cream/90 dark:bg-darkbg/90 rounded-2xl border-2 border-golden-light dark:border-golden p-4 md:p-6 mb-8 transition-all duration-300">
            <div class="space-y-6">
                <!-- Counter/progress ring at the top -->
                <div class="flex flex-col items-center gap-4">
                    <div class="relative flex flex-col items-center justify-center mb-2">
                        <svg class="progress-ring drop-shadow-lg" width="180" height="180">
                            <circle
                                class="progress-ring__bg"
                                stroke="#e0c97f33"
                                stroke-width="16"
                                fill="#fffbe6"
                                r="75"
                                cx="90"
                                cy="90"
                            />
                            <circle
                                class="progress-ring__circle"
                                stroke="#a67c2e"
                                stroke-width="16"
                                fill="transparent"
                                r="75"
                                cx="90"
                                cy="90"
                                style="stroke-dasharray:471.238, 471.238; stroke-dashoffset:471.238; transition: stroke-dashoffset 0.3s; filter: drop-shadow(0 2px 8px #e0c97f55);"
                            />
                        </svg>
                        <div class="absolute inset-0 flex flex-col items-center justify-center select-none cursor-pointer" id="progress-circle-click">
                            <div id="counter-display" class="text-5xl md:text-6xl font-bold text-golden dark:text-golden-light transition-all duration-300">0</div>
                            <div id="progress-percentage" class="text-golden-dark dark:text-golden-light text-lg mt-1"></div>
                        </div>
                    </div>
                </div>
                <!-- Dhikr type and custom input -->
                <div class="flex flex-col items-center gap-2 w-full md:w-2/3 mx-auto">
                    <label for="tasbeeh-type-select" class="text-golden-dark dark:text-golden-light">ููุน ุงูุฐูุฑ:</label>
                    <select id="tasbeeh-type-select" class="w-full bg-white dark:bg-darkbg border-2 border-golden-light dark:border-golden rounded-lg px-4 py-2 text-golden-dark dark:text-golden-light focus:outline-none focus:ring-2 focus:ring-golden transition-all duration-300">
                        <option value="ุณุจุญุงู ุงููู">ุณุจุญุงู ุงููู</option>
                        <option value="ุงูุญูุฏ ููู">ุงูุญูุฏ ููู</option>
                        <option value="ุงููู ุฃูุจุฑ">ุงููู ุฃูุจุฑ</option>
                        <option value="ูุง ุฅูู ุฅูุง ุงููู">ูุง ุฅูู ุฅูุง ุงููู</option>
                        <option value="ูุง ุญูู ููุง ููุฉ ุฅูุง ุจุงููู">ูุง ุญูู ููุง ููุฉ ุฅูุง ุจุงููู</option>
                        <option value="ุฃุณุชุบูุฑ ุงููู">ุฃุณุชุบูุฑ ุงููู</option>
                        <option value="ุณุจุญุงู ุงููู ูุจุญูุฏู">ุณุจุญุงู ุงููู ูุจุญูุฏู</option>
                        <option value="ุณุจุญุงู ุงููู ุงูุนุธูู">ุณุจุญุงู ุงููู ุงูุนุธูู</option>
                        <option value="ุงูููู ุตู ูุณูู ุนูู ูุจููุง ูุญูุฏ">ุงูููู ุตู ูุณูู ุนูู ูุจููุง ูุญูุฏ</option>
                        <option value="ุงูููู ุงุบูุฑ ูู">ุงูููู ุงุบูุฑ ูู</option>
                        <option value="ุฅุถุงูุฉ ุฐูุฑ ูุฎุตุต...">ุฅุถุงูุฉ ุฐูุฑ ูุฎุตุต...</option>
                    </select>
                    <div id="custom-dhikr-container" class="custom-dhikr-container">
                        <label for="custom-dhikr" class="custom-dhikr-label">ุฃุฏุฎู ุงูุฐูุฑ ุงููุฎุตุต:</label>
                        <div id="custom-dhikr-input-row" class="custom-dhikr-input-row">
                            <input type="text" id="custom-dhikr" class="custom-dhikr-input" placeholder="ุงูุชุจ ุงูุฐูุฑ ููุง...">
                            <button id="add-custom-dhikr-btn" class="btn-main custom-dhikr-add-btn" title="ุฅุถุงูุฉ">
                                ุฅุถุงูุฉ
                            </button>
                            <div id="custom-dhikr-list" class="custom-dhikr-list"></div>
                        </div>
                    </div>
                </div>
                <!-- Target count and custom input -->
                <div class="flex flex-col items-center gap-2 w-full md:w-2/3 mx-auto">
                    <label for="target-select" class="text-golden-dark dark:text-golden-light">ุงูุนุฏุฏ ุงููุทููุจ:</label>
                    <select id="target-select" class="w-full bg-white dark:bg-darkbg border-2 border-golden-light dark:border-golden rounded-lg px-4 py-2 text-golden-dark dark:text-golden-light focus:outline-none focus:ring-2 focus:ring-golden transition-all duration-300">
                        <option value="33">33</option>
                        <option value="100">100</option>
                        <option value="500">500</option>
                        <option value="1000">1000</option>
                        <option value="custom">ูุฎุตุต</option>
                        <option value="unlimited">ุบูุฑ ูุญุฏูุฏ</option>
                    </select>
                    <div id="custom-target-container" class="custom-target-container">
                        <label for="custom-target" class="custom-target-label">ุฃุฏุฎู ุงูุนุฏุฏ ุงููุทููุจ:</label>
                        <input type="number" id="custom-target" min="1" class="custom-target-input">
                    </div>
                </div>
                <!-- Reset button at the bottom -->
                <div class="flex justify-center">
                    <button id="reset-btn" class="bg-white dark:bg-darkbg border-2 border-golden-light dark:border-golden text-golden-dark dark:text-golden-light px-6 py-2 md:px-8 md:py-3 rounded-xl shadow-md hover:shadow-lg transition-all duration-300 text-lg">
                        ุฅุนุงุฏุฉ
                    </button>
                </div>
            </div>
        </section>

        <!-- Morning & Evening Adhkar Section -->
        <h2 id="adhkar-dynamic-title" class="label-section">
            ุฃุฐูุงุฑ ุงูุตุจุงุญ ูุงููุณุงุก
        </h2>
        <section class="bg-cream/90 dark:bg-darkbg/90 rounded-2xl border-2 border-golden-light dark:border-golden p-4 md:p-6 mb-8 transition-all duration-300">
            <div class="flex justify-between items-center mb-4">
                <button id="adhkar-audio-toggle" class="btn-main p-2 rounded-full">
                    <i class="fas fa-volume-up"></i>
                </button>
            </div>
            <div id="adhkar-dynamic-list" class="space-y-4 text-golden-dark dark:text-golden-light">
                <!-- Dynamic adhkar will be populated by script -->
                <div class="skeleton-loading h-24 rounded-lg"></div>
            </div>
        </section>

        <!-- After Prayer Adhkar Section -->
        <h2 class="label-section">
            ุฃุฐูุงุฑ ุจุนุฏ ุงูุตูุงุฉ
        </h2>
        <section class="bg-cream/90 dark:bg-darkbg/90 rounded-2xl border-2 border-golden-light dark:border-golden p-4 md:p-6 transition-all duration-300">
            <div id="after-prayer-list" class="space-y-4 text-golden-dark dark:text-golden-light">
                <div class="adhkar-item">
                    <span>ุฃุณุชุบูุฑ ุงููู</span> <span class="text-xs text-golden/70">(ูฃ ูุฑุงุช)</span>
                </div>
                <div class="adhkar-item">
                    <span>ุงูููู ุฃูุช ุงูุณูุงู ูููู ุงูุณูุงู ุชุจุงุฑูุช ูุง ุฐุง ุงูุฌูุงู ูุงูุฅูุฑุงู</span> <span class="text-xs text-golden/70">(ูุฑุฉ ูุงุญุฏุฉ)</span>
                </div>
                <div class="adhkar-item">
                    <span>ูุง ุฅูู ุฅูุง ุงููู ูุญุฏู ูุง ุดุฑูู ููุ ูู ุงูููู ููู ุงูุญูุฏ ููู ุนูู ูู ุดูุก ูุฏูุฑ. ุงูููู ูุง ูุงูุน ููุง ุฃุนุทูุช ููุง ูุนุทู ููุง ููุนุช ููุง ูููุน ุฐุง ุงูุฌุฏ ููู ุงูุฌุฏ</span> <span class="text-xs text-golden/70">(ูุฑุฉ ูุงุญุฏุฉ)</span>
                </div>
                <div class="adhkar-item">
                    <span>ุณุจุญุงู ุงููู</span> <span class="text-xs text-golden/70">(ูฃูฃ ูุฑุฉ)</span>
                </div>
                <div class="adhkar-item">
                    <span>ุงูุญูุฏ ููู</span> <span class="text-xs text-golden/70">(ูฃูฃ ูุฑุฉ)</span>
                </div>
                <div class="adhkar-item">
                    <span>ุงููู ุฃูุจุฑ</span> <span class="text-xs text-golden/70">(ูฃูฃ ูุฑุฉ)</span>
                </div>
                <div class="adhkar-item">
                    <span>ูุง ุฅูู ุฅูุง ุงููู ูุญุฏู ูุง ุดุฑูู ููุ ูู ุงูููู ููู ุงูุญูุฏ ููู ุนูู ูู ุดูุก ูุฏูุฑ</span> <span class="text-xs text-golden/70">(ุชูุงู ุงููุฆุฉ)</span>
                </div>
            </div>
        </section>

        <!-- Statistics/Analytics Section -->
        <h2 class="label-section">
            ุงูุฅุญุตุงุฆูุงุช
        </h2>
        <!-- Updated Statistics Section -->
        <section id="statistics-section" class="bg-white/90 dark:bg-darkbg/90 rounded-2xl border-2 border-golden-light dark:border-golden p-4 md:p-6 mb-8 transition-all duration-300">
          <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <!-- Total Tasbeeh Card -->
            <div class="stats-card">
              <div class="stats-icon"><i class="fas fa-praying-hands"></i></div>
              <div class="stats-value" id="stat-total-tasbeeh">0</div>
              <div class="stats-label">ุฅุฌูุงูู ุงูุชุณุจูุญ</div>
              <div class="stats-trend" id="tasbeeh-trend">
                <i class="fas fa-arrow-up text-green-500"></i>
                <span>12% ุฒูุงุฏุฉ</span>
              </div>
            </div>
            
            <!-- Favorites Card -->
            <div class="stats-card">
              <div class="stats-icon"><i class="fas fa-star"></i></div>
              <div class="stats-value" id="stat-favorites">0</div>
              <div class="stats-label">ุงูุฃุฐูุงุฑ ุงูููุถูุฉ</div>
            </div>
            
            <!-- Prayer Consistency Card -->
            <div class="stats-card">
              <div class="stats-icon"><i class="fas fa-calendar-check"></i></div>
              <div class="stats-value" id="stat-prayer-consistency">0%</div>
              <div class="stats-label">ุงูุชุธุงู ุงูุตูุงุฉ</div>
              <div class="progress-bar mt-2">
                <div class="progress-fill" id="prayer-progress"></div>
              </div>
            </div>
          </div>
          
          <!-- Tasbeeh Distribution Chart -->
          <div class="mt-8">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-lg font-bold text-golden-dark dark:text-golden-light">ุชูุฒูุน ุงูุชุณุจูุญ</h3>
              <select id="chart-period" class="chart-period-select">
                <option value="week">ุงูุฃุณุจูุน</option>
                <option value="month">ุงูุดูุฑ</option>
                <option value="year">ุงูุณูุฉ</option>
              </select>
            </div>
            <div class="chart-container">
              <canvas id="tasbeeh-chart" height="300"></canvas>
            </div>
          </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-golden-light/20 dark:bg-golden-dark/20 text-golden-dark dark:text-golden-light py-6 mt-8">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 md:mb-0 text-center md:text-right">
                    <h3 class="text-xl font-bold mb-1">ุชุทุจูู ุงูุฃุฐูุงุฑ</h3>
                    <p class="text-golden dark:text-golden-light/80 text-sm">ุชุทุจูู ูุชูุงูู ููุฃุฐูุงุฑ ูุฃููุงุช ุงูุตูุงุฉ</p>
                    <div class="hijri-date text-sm mt-1" lang="ar">
                      ุงูุชุงุฑูุฎ ุงููุฌุฑู: <span id="hijri-date-display">--/--/----</span>
                    </div>
                </div>
                <div class="flex gap-4 mb-4 md:mb-0">
                    <a href="#" aria-label="Facebook" class="footer-social-link">
                        <i class="fab fa-facebook-f text-lg"></i>
                    </a>
                    <a href="#" aria-label="Twitter" class="footer-social-link">
                        <i class="fab fa-twitter text-lg"></i>
                    </a>
                    <a href="#" aria-label="Instagram" class="footer-social-link">
                        <i class="fab fa-instagram text-lg"></i>
                    </a>
                </div>
            </div>
            <div class="border-t border-golden/20 dark:border-golden-light/20 mt-4 pt-4 text-center text-sm">
                <p>ยฉ 2025 ุชุทุจูู ุงูุฃุฐูุงุฑ. ุฌููุน ุงูุญููู ูุญููุธุฉ</p>
            </div>
        </div>
    </footer>

    <!-- Location Modal -->
    <div id="location-modal" class="hidden fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
        <div class="bg-white dark:bg-darkbg rounded-xl w-full max-w-md p-6">
            <h3 class="text-xl font-bold mb-4 text-golden-dark dark:text-golden-light">ุชุนููู ุงููููุน</h3>
            <div class="mb-4">
                <label class="block text-golden-dark dark:text-golden-light text-sm mb-2">ุฎุท ุงูุนุฑุถ</label>
                <input type="text" id="manual-lat" class="w-full bg-white dark:bg-darkbg border-2 border-golden-light dark:border-golden text-golden-dark dark:text-golden-light p-2 rounded-lg">
            </div>
            <div class="mb-4">
                <label class="block text-golden-dark dark:text-golden-light text-sm mb-2">ุฎุท ุงูุทูู</label>
                <input type="text" id="manual-lon" class="w-full bg-white dark:bg-darkbg border-2 border-golden-light dark:border-golden text-golden-dark dark:text-golden-light p-2 rounded-lg">
            </div>
            <div class="flex justify-end gap-2">
                <button id="cancel-location" class="btn-main btn-secondary">
                    ุฅูุบุงุก
                </button>
                <button id="save-location" class="btn-main">
                    ุญูุธ
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/profiles.js"></script>
    <script src="js/tasbeeh-inline.js"></script>
    <script src="js/common.js"></script>
    <script src="js/adhkar-dynamic.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="js/statistics.js"></script>
    <script src="js/sidebar-ui.js"></script>
</body>
</html>